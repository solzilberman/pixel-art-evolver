<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSE435 EC Demo</title>
    <link rel="stylesheet" href="styles/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.0/ace.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.0/mode-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.0/mode-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.0/theme-monokai.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Evolutionary Computation Demo</h1>
            <!-- <p>Generating 8x8 pixel art to match a target image - EC vs Random Search</p> -->
        </header>

        <div class="main-layout">
            <div class="sidebar">
                <div class="controls">
                    <h2>Settings</h2>
                    
                    <div class="control-group">
                        <label for="targetImage">Target Image:</label>
                        <select id="targetImage">
                            <option value="frog">Frog</option>
                            <option value="smiley">Smiley Face</option>
                            <option value="heart">Heart</option>
                            <option value="cross">Cross</option>
                            <option value="arrow">Arrow</option>
                            <option value="checker">Checkerboard</option>
                        </select>
                    </div>

                    <div class="target-display">
                        <h3>Target Image</h3>
                        <canvas id="targetCanvas" width="160" height="160"></canvas>
                    </div>

                    <div class="button-group">
                        <button id="startBtn">Start Evolution</button>
                        <button id="pauseBtn" disabled>Pause</button>
                        <button id="stopBtn" disabled>Stop</button>
                        <button id="resetBtn">Reset</button>
                    </div>
                </div>
            </div>

            <div class="comparison">
                <div class="algorithm-column">
                    <h2>Evolutionary Computation</h2>
                
                <div class="stats">
                    <div class="stat">
                        <span class="label">Generation:</span>
                        <span id="ecGeneration">0</span>
                    </div>
                    <div class="stat">
                        <span class="label">Best Fitness:</span>
                        <span id="ecBestFitness">0</span>
                    </div>
                    <div class="stat best-image-stat">
                        <span class="label">Best Image:</span>
                        <canvas id="ecBestImage" width="80" height="80"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="ecChart"></canvas>
                </div>

                <div class="top-images">
                    <h3>Best Individuals</h3>
                    <div id="ecTopImages" class="image-grid"></div>
                </div>

                <div class="code-section">
                    <h3 class="collapsible-header" onclick="toggleCodeSection(this)">
                        <span class="toggle-arrow">▶</span> Evolutionary Operators
                    </h3>
                    
                    <div class="code-content" style="display: none;">
                    <div class="code-box">
                        <div class="code-header">
                            <span>GA Parameters</span>
                            <button class="apply-btn" onclick="applyCode('parameters')">Apply</button>
                        </div>
                        <div id="parameters-editor" class="ace-editor-small"></div>
                    </div>
                    
                    <div class="code-box">
                        <div class="code-header">
                            <span>Crossover Operator</span>
                            <button class="apply-btn" onclick="applyCode('crossover')">Apply</button>
                        </div>
                        <div id="crossover-editor" class="ace-editor"></div>
                    </div>

                    <div class="code-box">
                        <div class="code-header">
                            <span>Mutation Operator</span>
                            <button class="apply-btn" onclick="applyCode('mutation')">Apply</button>
                        </div>
                        <div id="mutation-editor" class="ace-editor"></div>
                    </div>

                    <div class="code-box">
                        <div class="code-header">
                            <span>Selection Operator (tournament)</span>
                            <button class="apply-btn" onclick="applyCode('selection')">Apply</button>
                        </div>
                        <div id="selection-editor" class="ace-editor"></div>
                    </div>
                    </div>
                </div>
            </div>

            <div class="algorithm-column">
                <h2>Random Search</h2>
                
                <div class="stats">
                    <div class="stat">
                        <span class="label">Iterations:</span>
                        <span id="rsIterations">0</span>
                    </div>
                    <div class="stat">
                        <span class="label">Best Fitness:</span>
                        <span id="rsBestFitness">0</span>
                    </div>
                    <div class="stat best-image-stat">
                        <span class="label">Best Image:</span>
                        <canvas id="rsBestImage" width="80" height="80"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="rsChart"></canvas>
                </div>

                <div class="top-images">
                    <h3>Best Individuals</h3>
                    <div id="rsTopImages" class="image-grid"></div>
                </div>

                <div class="code-section">
                    <h3 class="collapsible-header" onclick="toggleCodeSection(this)">
                        <span class="toggle-arrow">▶</span> Random Search Algorithm
                    </h3>
                    
                    <div class="code-content" style="display: none;">
                    <div class="code-box">
                        <div class="code-header">
                            <span>Random Search Function</span>
                            <button class="apply-btn" onclick="applyCode('random-search')">Apply</button>
                        </div>
                        <div id="random-search-editor" class="ace-editor"></div>
                    </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>

    <script>
        function toggleCodeSection(header) {
            const codeContent = header.nextElementSibling;
            const arrow = header.querySelector('.toggle-arrow');
            
            if (codeContent.style.display === 'none') {
                codeContent.style.display = 'block';
                arrow.textContent = '▼';
                
                setTimeout(() => {
                    const editors = codeContent.querySelectorAll('.ace-editor, .ace-editor-small');
                    editors.forEach(editorElement => {
                        const editor = ace.edit(editorElement);
                        editor.resize();
                    });
                }, 50);
            } else {
                codeContent.style.display = 'none';
                arrow.textContent = '▶';
            }
        }
    </script>
    <script type="module" src="src/app.js"></script>
</body>
</html>
